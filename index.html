<!DOCTYPE html>
<html>
    <title>Addy Hashtags</title>
<head>
</head>
<style>
    body {
        display: grid;
        height: 100vh;
        margin: 0;
        place-items: center center;
    }
    div input{
        display: block
    }
    pre {
        font-family: Consolas,monospace;
        font-size: 1em;
    }
    input {
        width: 65vw;
    }
</style>
<body>
    <div>
        <pre>
<h1>#Hashtag your bookmarks!</h1>

Save website addresses and easily visit them using your custom #hashtags . . .
        </pre>
    </div>
    <div>
        <input id="hash" type="text" placeholder="#hashtag"><br>
        <input id="link" type="text" placeholder="https://www.google.com"><br>
        <button id="go">Save and Go!</button>
    </div>
    <div>
        <pre>
Visit your saved website by adding your hashtag to the url <span style="color: orange">https://www.addy.pw</span>.

    Example: 
    <span style="color: orange">https://www.addy.pw</span><span style="color: blue">#MemorableHashtag</span>

You can also create new addy hashtags by typing this in your address bar:

    Example: 
    <span style="color: orange">https://www.addy.pw</span><span style="color: red">?url=https://www.yourcoolurl.com</span><span style="color: blue">#MemorableHashtag</span>
        
Your addy hashtags are only accessibly from this device, but you can sync/share them between 
devices by scanning this QR code:

Or by sharing this link: 
        </pre>
    </div>
</body>
<script>
    let params = new URL(window.location).searchParams;
    let loc = window.location
    let hash = loc.hash;
    let url = params.get("url")
    let path = loc.path
    console.log(path)
    if(url && hash){
        url = checkUrl(url)
        if(url){
            localStorage.setItem(hash, url)
        }
    }
    if(hash && !url){
        let link = localStorage.getItem(hash)
        if(link){
            link = checkUrl(link)
        }
    }
    let button = document.getElementById("go")
    button.addEventListener("click", () => {
        let hash = document.getElementById("hash").value
        let link = document.getElementById("link").value 
        link = checkUrl(link)    
        if(hash && link){
            localStorage.setItem(hash, link)
        }
    })
    function checkUrl(url){
        let regEx = /^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/gm;

        if (regEx.test(url)) {
            document.body.innerHTML = 
            `<pre>Redirecting to <span style='color: red'>${url}"</span> using <span style='color: blue'>${hash}</span>  . . .</pre>`
            location.replace(url)
            return url
        } else {
            //alert("Please enter a complete url! (e.g. https://www.example.com)")
        }
    }
    let linkTyping = document.getElementById("link")
    linkTyping.addEventListener("keyup", event => {
        console.log(` ${event.key}`)
        if(event.key == "h"){
            linkTyping.value = "https://"
        }
    })
</script>
</html>